<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–•–æ—Ä–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–π –ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —à—Ä–∏—Ñ—Ç—É —Ç–∞ –±–∞–∑–æ–≤–æ–≥–æ —á–æ—Ä–Ω–æ–≥–æ —Ñ–æ–Ω—É */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* –î—É–∂–µ —Ç–µ–º–Ω–∏–π —á–æ—Ä–Ω–∏–π */
            color: #FFFFFF; /* –ë—ñ–ª–∏–π —Ç–µ–∫—Å—Ç */
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –≥–æ–ª–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
        .planner-container {
            background-color: #000000;
            border: 2px solid #FBBF24; /* –¢–µ–º–Ω–æ-–∂–æ–≤—Ç–∏–π –∞–∫—Ü–µ–Ω—Ç */
            border-radius: 12px;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5);
            max-width: 800px;
            width: 100%;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏-–∞–∫—Ü–µ–Ω—Ç—É (—Ç–µ–º–Ω–æ-–∂–æ–≤—Ç–∏–π) */
        .accent-button {
            background-color: #FBBF24;
            color: #000000;
            font-weight: bold;
            transition: background-color 0.1s;
        }

        .accent-button:hover:not(:disabled) {
            background-color: #F59E0B;
        }

        .accent-button:disabled {
            background-color: #4B5563;
            cursor: not-allowed;
            color: #D1D5DB;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è Canvas (–°—Ü–µ–Ω–∞) */
        #stage-canvas {
            border: 1px solid #FBBF24;
            background-color: #374151; /* –¢–µ–º–Ω–æ-—Å—ñ—Ä–∏–π —Ñ–æ–Ω —Å—Ü–µ–Ω–∏ */
            cursor: pointer;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å Canvas */
        .canvas-wrapper {
            width: 100%;
            /* –ó–∞–±–µ–∑–ø–µ—á—É—î–º–æ —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω 16:9 –¥–ª—è —Å—Ü–µ–Ω–∏ */
            aspect-ratio: 16 / 9; 
            margin: 0 auto;
        }
    </style>
</head>
<body>

    <div class="planner-container p-6">
        <h1 class="text-3xl font-extrabold text-center mb-4">–•–æ—Ä–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–π –ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫</h1>
        <p class="text-center text-sm mb-4 text-gray-400">–ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ —Å—Ü–µ–Ω—ñ, —â–æ–± –¥–æ–¥–∞—Ç–∏ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç–∞. –ü–µ—Ä–µ—Ç—è–≥—É–π—Ç–µ, —â–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é.</p>

        <!-- CANVAS –î–õ–Ø –°–¶–ï–ù–ò -->
        <div class="canvas-wrapper mb-6">
            <canvas id="stage-canvas" class="rounded-lg w-full h-full"></canvas>
        </div>
        
        <!-- –ù–û–í–ò–ô –ë–õ–û–ö: –í–∏–±—ñ—Ä –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ü–µ—Ä–µ—Ö–æ–¥—ñ–≤ -->
        <div class="mb-6 border-t border-gray-700 pt-4">
            <h3 class="text-xl font-bold mb-2 text-white">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ü–µ—Ä–µ—Ö–æ–¥–∏ (–®–∞–±–ª–æ–Ω–∏)</h3>
            <div class="flex space-x-4 items-center">
                <select id="presetSelector" class="flex-1 p-3 rounded-lg bg-gray-700 text-white border border-gray-600">
                    <option value="">-- –û–±–µ—Ä—ñ—Ç—å —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ—Ö–æ–¥—É --</option>
                    <!-- –û–ø—Ü—ñ—ó –¥–æ–¥–∞—é—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ -->
                </select>
                <button id="applyPresetBtn" class="accent-button px-4 py-3 rounded-lg" disabled>
                    –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –®–∞–±–ª–æ–Ω
                </button>
            </div>
            <p class="text-xs text-gray-500 mt-2">–ü—Ä–∏ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—ñ —à–∞–±–ª–æ–Ω—É –ø–æ—Ç–æ—á–Ω—ñ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç–∏ —Ç–∞ —Ñ–æ—Ä–º–∞—Ü—ñ—ó –±—É–¥—É—Ç—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω—ñ.</p>
        </div>


        <!-- –ü–ê–ù–ï–õ–¨ –ö–ï–†–£–í–ê–ù–ù–Ø –¢–ê–ù–¶–Æ–†–ò–°–¢–ê–ú–ò -->
        <div class="flex flex-wrap justify-between items-center gap-4 mb-6">
            <button id="addDancerBtn" class="accent-button px-4 py-2 rounded-lg">
                ‚ûï –î–æ–¥–∞—Ç–∏ –¢–∞–Ω—Ü—é—Ä–∏—Å—Ç–∞
            </button>
            <div class="text-lg font-bold text-white">
                –¢–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤: <span id="dancerCount">0</span>
            </div>
            <button id="clearDancersBtn" class="bg-red-700 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition">
                ‚ùå –û—á–∏—Å—Ç–∏—Ç–∏ –°—Ü–µ–Ω—É
            </button>
        </div>

        <!-- –ö–û–ù–¢–†–û–õ–¨ –§–û–†–ú–ê–¶–Ü–ô -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <button id="setFormationABtn" class="bg-white text-black px-4 py-3 rounded-lg font-bold hover:bg-gray-200 transition">
                –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –§–û–†–ú–ê–¶–Ü–Æ A
            </button>
            <button id="animateBtn" class="accent-button px-4 py-3 rounded-lg text-lg" disabled>
                ‚û°Ô∏è –ê–Ω—ñ–º—É–≤–∞—Ç–∏ A &rarr; B
            </button>
            <button id="setFormationBBtn" class="bg-white text-black px-4 py-3 rounded-lg font-bold hover:bg-gray-200 transition" disabled>
                –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –§–û–†–ú–ê–¶–Ü–Æ B
            </button>
        </div>

        <!-- –Ü–ù–°–¢–†–£–ú–ï–ù–¢–ò -->
        <div class="mb-4">
            <label for="animationDuration" class="block text-sm font-medium mb-2">–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ê–Ω—ñ–º–∞—Ü—ñ—ó (—Å):</label>
            <input type="number" id="animationDuration" value="2" min="0.5" step="0.5" class="w-full p-2 rounded-lg bg-gray-700 text-white border border-gray-600">
        </div>

        <!-- –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø/–ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø (JSON) -->
        <div class="mb-4">
            <h3 class="text-lg font-bold mb-2 text-gray-300">–î–∞–Ω—ñ –§–æ—Ä–º–∞—Ü—ñ—ó (JSON)</h3>
            <textarea id="formationData" rows="4" class="w-full p-2 rounded-lg bg-gray-900 text-green-300 font-mono text-sm" readonly placeholder="–§–æ—Ä–º–∞—Ç JSON –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è/–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ü—ñ–π."></textarea>
        </div>
        <div class="flex space-x-4">
            <button id="copyJsonBtn" class="bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition flex-1">
                üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏ JSON
            </button>
            <button id="loadJsonBtn" class="bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition flex-1">
                –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ JSON
            </button>
        </div>
        <p id="statusMessage" class="mt-4 text-center text-sm text-gray-400">–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏.</p>
    </div>

    <script>
        const canvas = document.getElementById('stage-canvas');
        const ctx = canvas.getContext('2d');
        const dancerCountDisplay = document.getElementById('dancerCount');
        const addDancerBtn = document.getElementById('addDancerBtn');
        const clearDancersBtn = document.getElementById('clearDancersBtn');
        const setFormationABtn = document.getElementById('setFormationABtn');
        const setFormationBBtn = document.getElementById('setFormationBBtn');
        const animateBtn = document.getElementById('animateBtn');
        const durationInput = document.getElementById('animationDuration');
        const formationDataArea = document.getElementById('formationData');
        const copyJsonBtn = document.getElementById('copyJsonBtn');
        const loadJsonBtn = document.getElementById('loadJsonBtn');
        const statusMessage = document.getElementById('statusMessage');
        
        // –ù–æ–≤—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –¥–ª—è —à–∞–±–ª–æ–Ω—ñ–≤
        const presetSelector = document.getElementById('presetSelector');
        const applyPresetBtn = document.getElementById('applyPresetBtn');

        let dancers = [];
        let formationA = [];
        let formationB = [];
        let isDragging = false;
        let draggedDancer = null;
        let animationStartTime = 0;
        let animationDuration = 2000; // 2 —Å–µ–∫—É–Ω–¥–∏ —É –º—Å

        const DANCER_RADIUS = 15;
        let DANCER_ID_COUNTER = 1;
        const STAGE_HEIGHT_RATIO = 0.9; // –°—Ü–µ–Ω–∞ –∑–∞–π–º–∞—î 90% –≤–∏—Å–æ—Ç–∏

        // --- –ö–ª–∞—Å –¢–∞–Ω—Ü—é—Ä–∏—Å—Ç–∞ ---
        class Dancer {
            constructor(id, x, y, color = '#FFFFFF') {
                this.id = id;
                this.x = x;
                this.y = y;
                this.color = color;
                this.isHighlighted = false;
            }

            draw(context) {
                context.beginPath();
                context.arc(this.x, this.y, DANCER_RADIUS, 0, Math.PI * 2);
                context.fillStyle = this.isHighlighted ? '#FBBF24' : this.color; /* –ñ–æ–≤—Ç–∏–π, —è–∫—â–æ –≤–∏–¥—ñ–ª–µ–Ω–æ */
                context.fill();
                context.strokeStyle = '#000000';
                context.lineWidth = 2;
                context.stroke();

                // –ú–∞–ª—é—î–º–æ ID
                context.fillStyle = '#000000';
                context.font = '12px Inter';
                context.textAlign = 'center';
                context.textBaseline = 'middle';
                context.fillText(this.id, this.x, this.y);
            }

            isHit(mx, my) {
                const dist = Math.sqrt((mx - this.x) ** 2 + (my - this.y) ** 2);
                return dist < DANCER_RADIUS;
            }
        }
        
        // --- –ü–ï–†–ï–•–û–î–ò-–®–ê–ë–õ–û–ù–ò (PRESET_TRANSITIONS) ---
        // –§—É–Ω–∫—Ü—ñ—è –ø–æ–≤–µ—Ä—Ç–∞—î –≤—ñ–¥–Ω–æ—Å–Ω—ñ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ (rx, ry –≤—ñ–¥ 0 –¥–æ 1) –¥–ª—è –§–æ—Ä–º–∞—Ü—ñ–π A —ñ B.
        // –í–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ —Å—é–¥–∏ —â–µ 20+ —à–∞–±–ª–æ–Ω—ñ–≤!
        const PRESET_TRANSITIONS = {
            // 1. –ó—ñ—Ä–∫–∞ -> –ö–æ–ª–æ (–î–ª—è 5 —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤)
            'StarToCircle_5': (N) => {
                const A = [ // –ó—ñ—Ä–∫–∞
                    { rx: 0.5, ry: 0.15 }, { rx: 0.8, ry: 0.4 }, { rx: 0.65, ry: 0.75 },
                    { rx: 0.35, ry: 0.75 }, { rx: 0.2, ry: 0.4 }
                ]; 
                const B = [ // –ö–æ–ª–æ (–ü'—è—Ç–∏–∫—É—Ç–Ω–∏–∫)
                    { rx: 0.5, ry: 0.2 }, { rx: 0.7, ry: 0.35 }, { rx: 0.6, ry: 0.65 },
                    { rx: 0.4, ry: 0.65 }, { rx: 0.3, ry: 0.35 }
                ];
                return { formationA_rel: A.slice(0, N), formationB_rel: B.slice(0, N), max: 5 };
            },
            // 2. –î–≤—ñ –õ—ñ–Ω—ñ—ó -> –î—ñ–∞–≥–æ–Ω–∞–ª—å (–î–ª—è 6 —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤)
            'LinesToDiagonal_6': (N) => {
                const A = [ // –î–≤—ñ –ª—ñ–Ω—ñ—ó
                    { rx: 0.3, ry: 0.2 }, { rx: 0.3, ry: 0.5 }, { rx: 0.3, ry: 0.8 }, 
                    { rx: 0.7, ry: 0.2 }, { rx: 0.7, ry: 0.5 }, { rx: 0.7, ry: 0.8 } 
                ];
                const B = [ // –î—ñ–∞–≥–æ–Ω–∞–ª—å
                    { rx: 0.1, ry: 0.8 }, { rx: 0.25, ry: 0.65 }, { rx: 0.4, ry: 0.5 },
                    { rx: 0.6, ry: 0.35 }, { rx: 0.75, ry: 0.2 }, { rx: 0.9, ry: 0.05 }
                ]; 
                return { formationA_rel: A.slice(0, N), formationB_rel: B.slice(0, N), max: 6 };
            },
            // 3. –°—Ç—ñ–Ω–∞ -> –¶–µ–Ω—Ç—Ä (–î–ª—è 8 —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤)
            'WallToCenter_8': (N) => {
                const A = [ // –°—Ç—ñ–Ω–∞ (–¥–≤—ñ –ø–æ–ª–æ–≤–∏–Ω–∏)
                    { rx: 0.05, ry: 0.2 }, { rx: 0.05, ry: 0.4 }, { rx: 0.05, ry: 0.6 }, { rx: 0.05, ry: 0.8 }, 
                    { rx: 0.95, ry: 0.2 }, { rx: 0.95, ry: 0.4 }, { rx: 0.95, ry: 0.6 }, { rx: 0.95, ry: 0.8 }  
                ];
                const B = [ // –ö–≤–∞–¥—Ä–∞—Ç —É —Ü–µ–Ω—Ç—Ä—ñ
                    { rx: 0.4, ry: 0.4 }, { rx: 0.6, ry: 0.4 },
                    { rx: 0.4, ry: 0.6 }, { rx: 0.6, ry: 0.6 },
                    { rx: 0.5, ry: 0.3 }, { rx: 0.5, ry: 0.7 },
                    { rx: 0.3, ry: 0.5 }, { rx: 0.7, ry: 0.5 }
                ]; 
                return { formationA_rel: A.slice(0, N), formationB_rel: B.slice(0, N), max: 8 };
            },
            // 4. –î–≤—ñ –ö–æ–ª–æ–Ω–∏ -> –•–≤–∏–ª—è (–î–ª—è 4 —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤)
            'ColumnsToWave_4': (N) => {
                const A = [ // –ö–æ–ª–æ–Ω–∏
                    { rx: 0.3, ry: 0.3 }, { rx: 0.3, ry: 0.7 }, 
                    { rx: 0.7, ry: 0.3 }, { rx: 0.7, ry: 0.7 }
                ];
                const B = [ // –•–≤–∏–ª—è
                    { rx: 0.1, ry: 0.5 }, { rx: 0.4, ry: 0.25 }, 
                    { rx: 0.6, ry: 0.75 }, { rx: 0.9, ry: 0.5 }
                ];
                return { formationA_rel: A.slice(0, N), formationB_rel: B.slice(0, N), max: 4 };
            },
            // 5. –í–∏–±—É—Ö (–î–ª—è 10 —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤)
             'Explosion_10': (N) => {
                const A = [ // –°–∫—É–ø—á–µ–Ω–Ω—è –≤ —Ü–µ–Ω—Ç—Ä—ñ
                    { rx: 0.45, ry: 0.45 }, { rx: 0.55, ry: 0.45 }, { rx: 0.45, ry: 0.55 }, { rx: 0.55, ry: 0.55 },
                    { rx: 0.48, ry: 0.48 }, { rx: 0.52, ry: 0.48 }, { rx: 0.48, ry: 0.52 }, { rx: 0.52, ry: 0.52 },
                    { rx: 0.5, ry: 0.4 }, { rx: 0.5, ry: 0.6 },
                ];
                const B = [ // –í–∏–±—É—Ö –¥–æ –∫—Ä–∞—ó–≤
                    { rx: 0.1, ry: 0.1 }, { rx: 0.9, ry: 0.1 }, { rx: 0.1, ry: 0.8 }, { rx: 0.9, ry: 0.8 },
                    { rx: 0.5, ry: 0.05 }, { rx: 0.5, ry: 0.85 }, { rx: 0.05, ry: 0.5 }, { rx: 0.95, ry: 0.5 },
                    { rx: 0.25, ry: 0.25 }, { rx: 0.75, ry: 0.75 },
                ];
                return { formationA_rel: A.slice(0, N), formationB_rel: B.slice(0, N), max: 10 };
            }
        };

        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –æ–ø—Ü—ñ–π –¥–æ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞
        Object.entries(PRESET_TRANSITIONS).forEach(([key, value]) => {
            const option = document.createElement('option');
            option.value = key;
            option.textContent = key.replace(/_/g, ' ').replace('To', ' ‚Üí ') + ` (–¥–æ ${value().max} —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤)`;
            presetSelector.appendChild(option);
        });


        // --- –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ –ú–∞–ª—é–≤–∞–Ω–Ω—è ---

        function resizeCanvas() {
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ä–æ–∑–º—ñ—Ä Canvas –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ä–æ–∑–º—ñ—Ä—É –æ–±–≥–æ—Ä—Ç–∫–∏ (wrapper)
            const wrapper = canvas.parentElement;
            canvas.width = wrapper.clientWidth;
            canvas.height = wrapper.clientHeight;
            draw();
        }

        function draw() {
            const stageHeight = canvas.height * STAGE_HEIGHT_RATIO;
            
            // 1. –û—á–∏—â–µ–Ω–Ω—è –°—Ü–µ–Ω–∏
            ctx.fillStyle = '#374151';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // 2. –ì–õ–Ø–î–ê–ß–Ü
            ctx.fillStyle = '#1F2937'; /* –¢–µ–º–Ω—ñ—à–∏–π —Å—ñ—Ä–∏–π –¥–ª—è –∑–æ–Ω–∏ –≥–ª—è–¥–∞—á—ñ–≤ */
            ctx.fillRect(0, stageHeight, canvas.width, canvas.height * (1 - STAGE_HEIGHT_RATIO));
            ctx.fillStyle = '#FBBF24'; /* –ñ–æ–≤—Ç–∏–π –∞–∫—Ü–µ–Ω—Ç */
            ctx.font = '14px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('–ì–õ–Ø–î–ê–ß–Ü', canvas.width / 2, canvas.height * STAGE_HEIGHT_RATIO + 20);
            
            // 3. –°–¢–ê–¢–ò–ß–ù–ê –†–û–ó–ú–Ü–¢–ö–ê –°–¶–ï–ù–ò (–¢–Ü–õ–¨–ö–ò –ù–ê –°–¶–ï–ù–Ü)
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)'; /* –ë—ñ–ª—ñ, –Ω–∞–ø—ñ–≤–ø—Ä–æ–∑–æ—Ä—ñ –ª—ñ–Ω—ñ—ó */
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]); // –ü—É–Ω–∫—Ç–∏—Ä

            // –¶–µ–Ω—Ç—Ä –°—Ü–µ–Ω–∏ (–í–µ—Ä—Ç–∏–∫–∞–ª—å)
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, stageHeight);
            ctx.stroke();

            // –°–µ—Ä–µ–¥–∏–Ω–∞ –°—Ü–µ–Ω–∏ (–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å)
            ctx.beginPath();
            ctx.moveTo(0, stageHeight / 2);
            ctx.lineTo(canvas.width, stageHeight / 2);
            ctx.stroke();

            // –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ñ –ª—ñ–Ω—ñ—ó (1/4 —ñ 3/4)
            ctx.beginPath();
            ctx.moveTo(canvas.width * 0.25, 0);
            ctx.lineTo(canvas.width * 0.25, stageHeight);
            ctx.moveTo(canvas.width * 0.75, 0);
            ctx.lineTo(canvas.width * 0.75, stageHeight);
            ctx.stroke();

            ctx.setLineDash([]); // –°–∫–∏–¥–∞—î–º–æ –ø—É–Ω–∫—Ç–∏—Ä


            // 4. –ú–∞–ª—é—î–º–æ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤
            dancers.forEach(dancer => dancer.draw(ctx));

            // 5. –ü–µ—Ä–µ–º–∞–ª—å–æ–≤—É—î–º–æ, —è–∫—â–æ –∞–∫—Ç–∏–≤–Ω–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è
            if (animationStartTime > 0) {
                requestAnimationFrame(animateTransition);
            }
        }

        // --- –ê–Ω—ñ–º–∞—Ü—ñ—è ---

        function animateTransition(timestamp) {
            if (!animationStartTime) animationStartTime = timestamp;

            const elapsed = timestamp - animationStartTime;
            const progress = Math.min(1, elapsed / animationDuration); // –ü—Ä–æ–≥—Ä–µ—Å –≤—ñ–¥ 0 –¥–æ 1

            dancers.forEach((dancer, index) => {
                const startPos = formationA[index];
                const endPos = formationB[index];

                if (startPos && endPos) {
                    // –õ—ñ–Ω—ñ–π–Ω–∞ —ñ–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü—ñ—è –ø–æ–∑–∏—Ü—ñ–π
                    dancer.x = startPos.x + (endPos.x - startPos.x) * progress;
                    dancer.y = startPos.y + (endPos.y - startPos.y) * progress;
                }
            });

            draw();

            if (progress < 1) {
                requestAnimationFrame(animateTransition);
            } else {
                // –ê–Ω—ñ–º–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
                animationStartTime = 0;
                statusMessage.textContent = '–ê–Ω—ñ–º–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –¢–∞–Ω—Ü—é—Ä–∏—Å—Ç–∏ —É –§–æ—Ä–º–∞—Ü—ñ—ó B.';
                // –û–Ω–æ–≤–ª—é—î–º–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ –ø–æ–∑–∏—Ü—ñ—ó dancers –¥–æ –∫—ñ–Ω—Ü–µ–≤–∏—Ö B
                dancers.forEach((dancer, index) => {
                    dancer.x = formationB[index].x;
                    dancer.y = formationB[index].y;
                });
                draw();
            }
        }

        // --- –ö–µ—Ä—É–≤–∞–Ω–Ω—è –î–∞–Ω–∏–º–∏ ---

        function updateDancerCount() {
            dancerCountDisplay.textContent = dancers.length;
            // –ê–∫—Ç–∏–≤–∞—Ü—ñ—è –∫–Ω–æ–ø–∫–∏ "–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –§–æ—Ä–º–∞—Ü—ñ—é B" —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ê
            setFormationBBtn.disabled = formationA.length === 0;
            // –ê–∫—Ç–∏–≤–∞—Ü—ñ—è –∫–Ω–æ–ø–∫–∏ "–ê–Ω—ñ–º—É–≤–∞—Ç–∏" —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–±–æ—Ö —Ñ–æ—Ä–º–∞—Ü—ñ–π
            animateBtn.disabled = formationA.length === 0 || formationB.length === 0 || formationA.length !== formationB.length;
            
            applyPresetBtn.disabled = presetSelector.value === '';

            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è JSON –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è
            updateFormationJson();
        }

        function updateFormationJson() {
            const data = {
                dancers: dancers.map(d => ({ id: d.id, x: d.x, y: d.y, color: d.color })),
                formationA: formationA.map(f => ({ id: f.id, x: f.x, y: f.y })),
                formationB: formationB.map(f => ({ id: f.id, x: f.x, y: f.y }))
            };
            formationDataArea.value = JSON.stringify(data, null, 2);
        }

        // --- –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π Canvas (–ö–µ—Ä—É–≤–∞–Ω–Ω—è –º–∏—à–µ—é) ---

        canvas.addEventListener('mousedown', (e) => {
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;

            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –º–∏ –Ω–∞—Ç–∏—Å–Ω—É–ª–∏ –Ω–∞ —ñ—Å–Ω—É—é—á–æ–≥–æ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç–∞
            draggedDancer = dancers.find(d => d.isHit(mouseX, mouseY));

            dancers.forEach(d => d.isHighlighted = false); // –°–∫–∏–¥–∞—î–º–æ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è

            if (draggedDancer) {
                isDragging = true;
                draggedDancer.isHighlighted = true;
                draw();
            } else if (mouseY < canvas.height * STAGE_HEIGHT_RATIO) { // –î–æ–¥–∞—î–º–æ, —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –∫–ª—ñ–∫ –Ω–∞ —Å—Ü–µ–Ω—ñ
                // –Ø–∫—â–æ –Ω–∞—Ç–∏—Å–Ω—É–ª–∏ –Ω–∞ –ø–æ—Ä–æ–∂–Ω—å–æ–º—É –º—ñ—Å—Ü—ñ, –¥–æ–¥–∞—î–º–æ –Ω–æ–≤–æ–≥–æ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç–∞
                addDancer(mouseX, mouseY);
            }
        });

        canvas.addEventListener('mousemove', (e) => {
            if (!isDragging || !draggedDancer) return;

            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;

            // –û–±–º–µ–∂—É—î–º–æ —Ä—É—Ö –≤ –º–µ–∂–∞—Ö –°—Ü–µ–Ω–∏ (–Ω–µ –≥–ª—è–¥–∞—á—ñ–≤)
            draggedDancer.x = Math.min(Math.max(mouseX, DANCER_RADIUS), canvas.width - DANCER_RADIUS);
            draggedDancer.y = Math.min(Math.max(mouseY, DANCER_RADIUS), canvas.height * STAGE_HEIGHT_RATIO - DANCER_RADIUS);

            draw();
        });

        canvas.addEventListener('mouseup', () => {
            isDragging = false;
            draggedDancer = null;
            draw();
        });

        // --- –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –ö–Ω–æ–ø–æ–∫ ---

        function addDancer(x = canvas.width / 2, y = canvas.height / 2) {
            const newDancer = new Dancer(DANCER_ID_COUNTER++, x, y, '#FFFFFF');
            dancers.push(newDancer);
            updateDancerCount();
            draw();
            statusMessage.textContent = `–î–æ–¥–∞–Ω–æ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç–∞ #${newDancer.id}.`;
        }

        addDancerBtn.addEventListener('click', () => {
            // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ü–µ–Ω—Ç—Ä —Å—Ü–µ–Ω–∏
            addDancer(canvas.width / 2, (canvas.height * STAGE_HEIGHT_RATIO) / 2);
        });

        clearDancersBtn.addEventListener('click', () => {
            statusMessage.textContent = '–°—Ü–µ–Ω–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –æ—á–∏—â–µ–Ω–∞.';
            console.warn('–°—Ü–µ–Ω–∞ –æ—á–∏—â–µ–Ω–∞. –í—Å—ñ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç–∏ —Ç–∞ —Ñ–æ—Ä–º–∞—Ü—ñ—ó —Å–∫–∏–Ω—É—Ç—ñ.');
            dancers = [];
            formationA = [];
            formationB = [];
            DANCER_ID_COUNTER = 1;
            updateDancerCount();
            draw();
            // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–Ω–æ–ø–∫–∏ –¥–æ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Å—Ç–∞–Ω—É
            setFormationABtn.textContent = '–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –§–û–†–ú–ê–¶–Ü–Æ A';
            setFormationBBtn.textContent = '–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –§–û–†–ú–ê–¶–Ü–Æ B';
        });

        setFormationABtn.addEventListener('click', () => {
            if (dancers.length === 0) {
                statusMessage.textContent = '–î–æ–¥–∞–π—Ç–µ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤, –ø–µ—Ä—à –Ω—ñ–∂ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ñ–æ—Ä–º–∞—Ü—ñ—é A.';
                return;
            }
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –∫–æ–ø—ñ—ó –ø–æ—Ç–æ—á–Ω–∏—Ö –ø–æ–∑–∏—Ü—ñ–π
            formationA = dancers.map(d => ({ id: d.id, x: d.x, y: d.y }));
            setFormationABtn.textContent = `‚úÖ –§–û–†–ú–ê–¶–Ü–Ø A (–ó–±–µ—Ä–µ–∂–µ–Ω–æ ${dancers.length} –ø–æ–∑–∏—Ü—ñ–π)`;
            setFormationBBtn.disabled = false;
            animateBtn.disabled = true; // –í–∏–º–∫–Ω—É—Ç–∏, –ø–æ–∫–∏ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ B
            updateDancerCount();
            statusMessage.textContent = '–§–æ—Ä–º–∞—Ü—ñ—è A —É—Å–ø—ñ—à–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–∞. –¢–µ–ø–µ—Ä –ø–µ—Ä–µ–º—ñ—Å—Ç—ñ—Ç—å —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤ —ñ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å B.';
        });

        setFormationBBtn.addEventListener('click', () => {
            if (formationA.length === 0) {
                statusMessage.textContent = '–°–ø–æ—á–∞—Ç–∫—É –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –§–æ—Ä–º–∞—Ü—ñ—é A.';
                return;
            }
            if (dancers.length !== formationA.length) {
                 statusMessage.textContent = `–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤ –Ω–µ –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ –§–æ—Ä–º–∞—Ü—ñ—î—é A (${formationA.length}).`;
                 return;
            }
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –∫–æ–ø—ñ—ó –ø–æ—Ç–æ—á–Ω–∏—Ö –ø–æ–∑–∏—Ü—ñ–π
            formationB = dancers.map(d => ({ id: d.id, x: d.x, y: d.y }));
            setFormationBBtn.textContent = `‚úÖ –§–û–†–ú–ê–¶–Ü–Ø B (–ó–±–µ—Ä–µ–∂–µ–Ω–æ ${dancers.length} –ø–æ–∑–∏—Ü—ñ–π)`;
            animateBtn.disabled = false;
            updateDancerCount();
            statusMessage.textContent = '–§–æ—Ä–º–∞—Ü—ñ—è B —É—Å–ø—ñ—à–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–∞. –ú–æ–∂–Ω–∞ –∞–Ω—ñ–º—É–≤–∞—Ç–∏ –ø–µ—Ä–µ—Ö—ñ–¥!';
        });

        animateBtn.addEventListener('click', () => {
            if (formationA.length !== formationB.length || formationA.length === 0) {
                statusMessage.textContent = '–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–±–∏–¥–≤—ñ —Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ –æ–¥–Ω–∞–∫–æ–≤–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤.';
                return;
            }
            
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤—ñ –ø–æ–∑–∏—Ü—ñ—ó —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤ –Ω–∞ –§–æ—Ä–º–∞—Ü—ñ—é A –ø–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º –∞–Ω—ñ–º–∞—Ü—ñ—ó
            dancers.forEach((dancer, index) => {
                dancer.x = formationA[index].x;
                dancer.y = formationA[index].y;
            });

            animationDuration = parseFloat(durationInput.value) * 1000;
            animationStartTime = 0; // –°–∫–∏–¥–∞—î–º–æ –¥–ª—è –ø–æ—á–∞—Ç–∫—É
            statusMessage.textContent = '–ü–æ—á–∞—Ç–æ–∫ –∞–Ω—ñ–º–∞—Ü—ñ—ó...';
            requestAnimationFrame(animateTransition);
        });

        // --- –û–±—Ä–æ–±–∫–∞ –®–∞–±–ª–æ–Ω—ñ–≤ ---
        
        presetSelector.addEventListener('change', () => {
            applyPresetBtn.disabled = presetSelector.value === '';
            if (presetSelector.value) {
                const maxDancers = PRESET_TRANSITIONS[presetSelector.value]().max;
                statusMessage.textContent = `–®–∞–±–ª–æ–Ω "${presetSelector.options[presetSelector.selectedIndex].textContent}" –≥–æ—Ç–æ–≤–∏–π. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–æ ${maxDancers} —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤.`;
            } else {
                statusMessage.textContent = '–û–±–µ—Ä—ñ—Ç—å —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ—Ö–æ–¥—É.';
            }
        });

        applyPresetBtn.addEventListener('click', () => {
            const presetKey = presetSelector.value;
            if (!presetKey || !PRESET_TRANSITIONS[presetKey]) return;

            const N = PRESET_TRANSITIONS[presetKey]().max;
            
            // 1. –û—á–∏—â–µ–Ω–Ω—è —Å—Ü–µ–Ω–∏ —Ç–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è N —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤
            dancers = [];
            DANCER_ID_COUNTER = 1;
            for (let i = 0; i < N; i++) {
                // –î–æ–¥–∞—î–º–æ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤ —É –≤–∏–ø–∞–¥–∫–æ–≤—É —Ç–æ—á–∫—É, —â–æ–± —ó—Ö –º–æ–∂–Ω–∞ –±—É–ª–æ –ø–µ—Ä–µ—Ç—è–≥–Ω—É—Ç–∏
                const newDancer = new Dancer(DANCER_ID_COUNTER++, 100 + i * 5, 100 + i * 5, '#FFFFFF');
                dancers.push(newDancer);
            }

            // 2. –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–Ω–æ—Å–Ω–∏—Ö –ø–æ–∑–∏—Ü—ñ–π
            const { formationA_rel, formationB_rel } = PRESET_TRANSITIONS[presetKey](N);
            
            // 3. –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ–¥–Ω–æ—Å–Ω–∏—Ö –ø–æ–∑–∏—Ü—ñ–π —É –∞–±—Å–æ–ª—é—Ç–Ω—ñ
            formationA = formationA_rel.map((pos, index) => ({ 
                id: dancers[index].id, // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π ID —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç–∞
                x: pos.rx * canvas.width, 
                y: pos.ry * canvas.height * STAGE_HEIGHT_RATIO 
            }));

            formationB = formationB_rel.map((pos, index) => ({ 
                id: dancers[index].id,
                x: pos.rx * canvas.width, 
                y: pos.ry * canvas.height * STAGE_HEIGHT_RATIO 
            }));

            // 4. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤ —É –§–æ—Ä–º–∞—Ü—ñ—é A
            dancers.forEach((dancer, index) => {
                dancer.x = formationA[index].x;
                dancer.y = formationA[index].y;
            });
            
            // 5. –û–Ω–æ–≤–ª–µ–Ω–Ω—è UI
            setFormationABtn.textContent = `‚úÖ –§–û–†–ú–ê–¶–Ü–Ø A (–®–∞–±–ª–æ–Ω: ${presetKey})`;
            setFormationBBtn.textContent = `‚úÖ –§–û–†–ú–ê–¶–Ü–Ø B (–®–∞–±–ª–æ–Ω: ${presetKey})`;
            updateDancerCount();
            draw();
            statusMessage.textContent = `–®–∞–±–ª–æ–Ω "${presetKey}" —É—Å–ø—ñ—à–Ω–æ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ. –¢–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤: ${N}. –ú–æ–∂–Ω–∞ –∞–Ω—ñ–º—É–≤–∞—Ç–∏!`;
        });


        // --- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è/–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è JSON ---
        
        copyJsonBtn.addEventListener('click', () => {
            formationDataArea.select();
            document.execCommand('copy');
            statusMessage.textContent = '–î–∞–Ω—ñ JSON —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º—ñ–Ω—É!';
        });

        loadJsonBtn.addEventListener('click', () => {
            try {
                const data = JSON.parse(formationDataArea.value);
                
                // –û—á–∏—â–∞—î–º–æ –ø–æ—Ç–æ—á–Ω—ñ –¥–∞–Ω—ñ
                dancers = [];
                formationA = [];
                formationB = [];
                DANCER_ID_COUNTER = 1;

                // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤
                if (data.dancers) {
                    dancers = data.dancers.map(d => new Dancer(d.id, d.x, d.y, d.color));
                    if (dancers.length > 0) {
                        // –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫, —â–æ–± –Ω–æ–≤—ñ —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç–∏ –º–∞–ª–∏ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ ID
                        DANCER_ID_COUNTER = Math.max(...dancers.map(d => d.id)) + 1;
                    }
                }

                // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ñ–æ—Ä–º–∞—Ü—ñ—ó A —ñ B
                if (data.formationA) formationA = data.formationA;
                if (data.formationB) formationB = data.formationB;

                setFormationABtn.textContent = formationA.length > 0 ? `‚úÖ –§–û–†–ú–ê–¶–Ü–Ø A (–ó–±–µ—Ä–µ–∂–µ–Ω–æ ${formationA.length} –ø–æ–∑–∏—Ü—ñ–π)` : '–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –§–û–†–ú–ê–¶–Ü–Æ A';
                setFormationBBtn.textContent = formationB.length > 0 ? `‚úÖ –§–û–†–ú–ê–¶–Ü–Ø B (–ó–±–µ—Ä–µ–∂–µ–Ω–æ ${formationB.length} –ø–æ–∑–∏—Ü—ñ–π)` : '–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –§–û–†–ú–ê–¶–Ü–Æ B';

                updateDancerCount();
                draw();
                statusMessage.textContent = '–î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑ JSON. –ì–æ—Ç–æ–≤–æ –¥–æ –∞–Ω—ñ–º–∞—Ü—ñ—ó.';
            } catch (e) {
                statusMessage.textContent = '–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è JSON. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö.';
                console.error('JSON Loading Error:', e);
            }
        });

        // --- –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è ---

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        updateDancerCount();
        draw(); // –ü–æ—á–∞—Ç–∫–æ–≤–µ –º–∞–ª—é–≤–∞–Ω–Ω—è

        // –î–æ–¥–∞—î–º–æ –∫—ñ–ª—å–∫–æ—Ö —Ç–∞–Ω—Ü—é—Ä–∏—Å—Ç—ñ–≤ –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É
        addDancer(canvas.width * 0.2, canvas.height * 0.45);
        addDancer(canvas.width * 0.8, canvas.height * 0.45);

    </script>
</body>
</html>
